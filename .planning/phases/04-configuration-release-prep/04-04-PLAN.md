---
phase: 04-configuration-release-prep
plan: 04
type: execute
wave: 3
depends_on: ["04-02", "04-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Mod builds and launches successfully with all config integration"
    - "Config file dread.json is created with correct defaults on first launch"
    - "modEnabled=false disables all Dread features in-game"
    - "Mod runs without crash when Iris shaders are installed"
  artifacts: []
  key_links: []
---

<objective>
Verify Phase 4 configuration and compatibility implementation.

Purpose: Human verification that config system works correctly, mod toggle functions, and shader compatibility behaves as expected.
Output: Verified Phase 4 implementation ready for release
</objective>

<execution_context>
@C:\Users\dylan\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\dylan\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-configuration-release-prep/04-01-SUMMARY.md
@.planning/phases/04-configuration-release-prep/04-02-SUMMARY.md
@.planning/phases/04-configuration-release-prep/04-03-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Phase 4 configuration system:
- GSON-based config with 7 configurable fields
- Config validation with clamping
- Master mod toggle (modEnabled)
- Spawn rate configuration (baseSpawnChancePerSecond, miningBonusPerBlock, dayEscalationCap)
- Damage configuration (dreadAttackDamage)
- Cinematic skip option (skipDeathCinematic)
- Downed effects toggle (disableDownedEffects)
- Iris/OptiFine detection with automatic fallback
  </what-built>
  <how-to-verify>
**Test 1: Config Generation**
1. Delete `config/dread.json` if it exists
2. Launch Minecraft with the mod
3. Verify `config/dread.json` is created in config directory
4. Open file and verify all fields present with default values:
   - baseSpawnChancePerSecond: 0.005
   - miningBonusPerBlock: 0.001
   - dayEscalationCap: 20
   - dreadAttackDamage: 20.0
   - modEnabled: true
   - skipDeathCinematic: false
   - disableDownedEffects: false

**Test 2: Mod Disable Toggle**
1. Edit `config/dread.json`: set `"modEnabled": false`
2. Restart Minecraft
3. Create/load a world
4. Wait 60+ seconds OR trigger mining activity
5. Verify NO Dread spawns (mod completely disabled)
6. If you have commands: `/kill @e[type=dread:dread]` should find nothing

**Test 3: Config Value Validation**
1. Edit `config/dread.json`: set `"baseSpawnChancePerSecond": 999.0`
2. Restart Minecraft
3. Open `config/dread.json` again
4. Verify value was clamped to `1.0` (maximum valid)

**Test 4: Shader Compatibility (if Iris installed)**
1. Install Iris shader mod if not already
2. Launch Minecraft with both Dread and Iris
3. Verify game does not crash
4. Check log for "Iris shader mod detected" message
5. Get killed by Dread (or use commands)
6. Verify downed state: HUD timer visible, blur/vignette NOT applied (fallback mode)

**Test 5: Force Disable Effects**
1. Edit `config/dread.json`: set `"disableDownedEffects": true`
2. Restart Minecraft (without Iris if you want to test this separately)
3. Get killed by Dread
4. Verify: HUD timer visible, blur/vignette NOT applied (forced off by config)

**Test 6: Skip Cinematic**
1. Edit `config/dread.json`: set `"skipDeathCinematic": true`
2. Restart Minecraft
3. Get killed by Dread
4. Verify: Death sound plays, but NO 4.5s camera lock to Dread face
5. Player immediately enters downed state with timer
  </how-to-verify>
  <resume-signal>
Type "approved" if all 6 tests pass.
If any test fails, describe the issue:
- Which test failed
- Expected vs actual behavior
- Any error messages or logs
  </resume-signal>
</task>

</tasks>

<verification>
Human verification that all configuration features work correctly.
</verification>

<success_criteria>
- Config file generates with correct defaults
- modEnabled=false disables all Dread features
- Invalid config values are clamped to valid ranges
- Iris detection works and disables post-processing
- disableDownedEffects forces effects off
- skipDeathCinematic bypasses camera lock
</success_criteria>

<output>
After completion, create `.planning/phases/04-configuration-release-prep/04-04-SUMMARY.md`
</output>
