---
phase: 14-animated-entity-textures
plan: 03
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - src/main/resources/assets/dread/animations/dread_entity.animation.json
autonomous: true

must_haves:
  truths:
    - "Tentacles have idle writhing animation visible during normal gameplay"
    - "Tentacle writhing intensifies during kill sequence"
    - "Animation is subtle, barely perceptible (persistent wrongness aesthetic)"
  artifacts:
    - path: "src/main/resources/assets/dread/animations/dread_entity.animation.json"
      provides: "tentacle_writhe animation with subtle undulation"
      contains: "tentacle_writhe"
  key_links:
    - from: "DreadEntity animation controller"
      to: "tentacle_writhe animation"
      via: "GeckoLib animation system"
      pattern: "tentacle_writhe"
---

<objective>
Add tentacle writhing animation to Dread entity for subtle idle motion and intensified kill sequence movement.

Purpose: Make Dread feel alive with subtle, constant appendage motion that enhances horror through uncertainty ("did it move?").

Output: Extended animation JSON with tentacle_writhe animation that can be triggered alongside idle/death_grab.
</objective>

<execution_context>
@C:\Users\dylan\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\dylan\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-animated-entity-textures/14-CONTEXT.md
@src/main/resources/assets/dread/animations/dread_entity.animation.json
@src/main/java/com/dread/entity/DreadEntity.java
</context>

<tasks>

<task type="auto">
  <name>Task 1: Read existing animation file structure</name>
  <files>src/main/resources/assets/dread/animations/dread_entity.animation.json</files>
  <action>
Read the existing animation JSON file to understand:
1. Animation format and structure used
2. Existing animation names (idle, walk, attack, spawn, despawn, head_track, death_grab)
3. Bone names available for tentacles
4. Animation timing patterns used in the project

This is a READ task to gather context for Task 2.
  </action>
  <verify>File contents read and bone names identified</verify>
  <done>Existing animation structure understood, bone names for tentacles identified</done>
</task>

<task type="auto">
  <name>Task 2: Add tentacle_writhe animation</name>
  <files>src/main/resources/assets/dread/animations/dread_entity.animation.json</files>
  <action>
Add a new "animation.dread_entity.tentacle_writhe" animation to the JSON file.

**Animation requirements from CONTEXT.md:**
- Subtle undulation — slow, barely perceptible shifting
- Constant intensity — same gentle motion throughout (persistent wrongness)
- Tentacle appendages only — main body stays still
- Loop: true (continuous during idle)

**Animation structure:**
```json
"animation.dread_entity.tentacle_writhe": {
    "loop": true,
    "animation_length": 4.0,
    "bones": {
        // For each tentacle bone, add subtle rotation oscillation
        // Example for tentacle_1:
        "tentacle_1": {
            "rotation": {
                "0.0": [0, 0, 0],
                "1.0": [3, 2, -2],
                "2.0": [0, 0, 0],
                "3.0": [-2, -3, 2],
                "4.0": [0, 0, 0]
            }
        }
        // Repeat for other tentacle bones with offset timing for organic feel
    }
}
```

**Design notes:**
- Small rotation values (2-5 degrees) for subtle motion
- 4-second loop for slow, organic feel
- Each tentacle bone should have slightly different timing/values for natural appearance
- If model has multiple tentacle segments (tentacle_1_base, tentacle_1_mid, tentacle_1_tip), animate with cascading motion

**If bone names are different:** Adapt to actual bone names from the model. Common patterns:
- tentacle_1, tentacle_2, tentacle_3, tentacle_4
- tentacle_left, tentacle_right
- appendage_1, appendage_2
  </action>
  <verify>JSON syntax valid: `python -m json.tool "X:/Vibe Coding/src/main/resources/assets/dread/animations/dread_entity.animation.json" > /dev/null && echo "Valid JSON"`</verify>
  <done>tentacle_writhe animation added to JSON with subtle rotation keyframes on tentacle bones</done>
</task>

<task type="auto">
  <name>Task 3: Wire tentacle animation to entity controller</name>
  <files>src/main/java/com/dread/entity/DreadEntity.java</files>
  <action>
Update DreadEntity's registerControllers() method to play tentacle_writhe animation alongside idle.

**GeckoLib animation controller pattern:**
1. Add new controller for tentacle animation (runs parallel to main animation controller)
2. Play tentacle_writhe continuously in background

**If using single controller approach:**
```java
// In registerControllers method, add to existing controller setup:
// Note: GeckoLib allows multiple animations on different bones simultaneously
```

**If using multi-controller approach (preferred for parallel animations):**
Add a second AnimationController for tentacle motion that runs independently:

```java
// In registerControllers:
controllers.add(new AnimationController<>(this, "tentacle_controller", 0, state -> {
    // Always play tentacle_writhe - it's subtle background motion
    return state.setAndContinue(RawAnimation.begin().thenLoop("tentacle_writhe"));
}));
```

**Intensified motion during kill sequence:**
The same animation plays faster or with multiplied values during death_grab. Two approaches:
1. Simple: Same animation, GeckoLib handles blending (preferred for simplicity)
2. Advanced: Add tentacle_writhe_intense animation with larger values (if subtle isn't visible enough)

Start with simple approach - same animation always playing. The death_grab animation will override on main body, tentacles continue writhing.
  </action>
  <verify>Build compiles: `export JAVA_HOME="X:/Vibe Coding/jdk-21.0.6+7" && cd "X:/Vibe Coding" && ./gradlew build --quiet`</verify>
  <done>Tentacle animation controller added to DreadEntity, tentacle_writhe plays continuously</done>
</task>

</tasks>

<verification>
1. Build succeeds with no errors
2. Animation JSON is valid and contains "animation.dread_entity.tentacle_writhe"
3. DreadEntity registers tentacle animation controller
4. Animation uses subtle rotation values (under 10 degrees) on tentacle bones
5. Animation loops continuously (loop: true)
</verification>

<success_criteria>
- tentacle_writhe animation exists in animation JSON
- Animation is subtle (small rotation values, slow 4s loop)
- Animation controller wired up in DreadEntity
- Build compiles successfully
- Animation will be visible during in-game testing
</success_criteria>

<output>
After completion, create `.planning/phases/14-animated-entity-textures/14-03-SUMMARY.md`
</output>
