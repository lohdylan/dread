# Milestone v1.2: Quick Fixes

**Status:** âœ… SHIPPED 2026-01-27
**Phases:** 9-12
**Total Plans:** 10

## Overview

Fix bugs, improve single-player experience, validate multiplayer stability. Focus on death cinematic smoothness, state cleanup on world exit, single-player forgiveness (not permanent spectator), and audio polish.

## Phases

### Phase 9: Cinematic Fix

**Goal**: Death cinematic is smooth, readable, and genuinely horrifying
**Depends on**: Phase 8 (previous milestone)
**Plans**: 1 plan

Plans:
- [x] 09-01: Camera mixin for render-time shake injection (fixes entity rotation feedback loop)

**Details:**
Applied camera shake at render-time via Camera.setRotation TAIL injection instead of entity rotation modification. Used mixin order 900 so shake applies before CrawlCameraMixin's pitch clamping (order 1000). Eliminates feedback loop where entity AI/animation was fighting with shake updates.

### Phase 10: State Cleanup

**Goal**: Downed state lifecycle is properly managed across world boundaries
**Depends on**: Phase 9
**Plans**: 2 plans

Plans:
- [x] 10-01: Disconnect/reconnect lifecycle handlers with escape penalty
- [x] 10-02: Gamemode change mixin and void/kill damage bypass

**Details:**
Created PlayerConnectionHandler for disconnect/reconnect lifecycle. Escape penalty system: players who disconnect while downed and reconnect get 2 HP, immunity, and warning message. GamemodeChangeMixin detects creative/spectator changes and clears downed state. Void/kill bypass allows immediate death (with cinematic if Dread nearby).

### Phase 11: Single-Player Forgiveness

**Goal**: Single-player death is punishing but not permanent, while multiplayer retains hardcore behavior
**Depends on**: Phase 10
**Plans**: 5 plans

Plans:
- [x] 11-01: Game mode detection infrastructure (GameModeDetector, config timeouts, mode-aware setDowned)
- [x] 11-02: Death outcome branching (singleplayer triggers cinematic + normal death, multiplayer spectator)
- [x] 11-03: Extended packet with mercy mode flag for client sync
- [x] 11-04: Client UI updates (MERCY/NO MERCY indicator, orange/red color scheme)
- [x] 11-05: Mode transitions on player join/leave, respawn debuff application

**Details:**
GameModeDetector utility determines mode per-downed-instance. Single-player: 30s timer, normal death (respawn at bed/spawn) with Weakness II + Slowness I debuff. Multiplayer: 300s timer, permanent spectator. Mode transitions scale timer proportionally when players join/leave. Client shows MERCY MODE (orange) or NO MERCY (red) indicator.

### Phase 12: Audio & Testing

**Goal**: Audio polish complete, multiplayer stability validated
**Depends on**: Phase 11
**Plans**: 2 plans

Plans:
- [x] 12-01: Add grab_impact.ogg sound file and register in sounds.json
- [x] 12-02: Comprehensive single-player and multiplayer testing with test report

**Details:**
Added 15KB grab_impact.ogg file, registered in sounds.json, wired to animation keyframe 0.0. Comprehensive testing with 64 test scenarios. Single-player: 30/30 tests PASS. Multiplayer: 34 tests SKIPPED (no test environment). Conditional pass for single-player release.

---

## Milestone Summary

**Decimal Phases:** None

**Key Decisions:**
- Apply camera shake at render-time via mixin injection (not entity rotation)
- Use mixin order parameter to control injection sequence
- Escape tracking is transient (not persisted) - clears on server restart
- Void/kill bypass: don't trigger cinematic (re-applies downed effects causing broken state)
- Single-player death triggers player.kill() for normal Minecraft death flow
- Mode transitions use proportional timer scaling to prevent exploits
- Skip death cinematic in singleplayer (cinematic is for multiplayer spectator transition only)

**Issues Resolved:**
- Death cinematic camera flickering (entity rotation feedback loop)
- Downed state persisting across world boundaries
- Single-player permanent death too punishing
- Missing grab_impact.ogg audio

**Issues Deferred:**
- Multiplayer dedicated server testing (TEST-01) - no LAN setup available
- Multiplayer sync validation (TEST-02) - depends on TEST-01

**Technical Debt Incurred:**
- Multiplayer features implemented but unverified (code complete, runtime testing pending)

---

*For current project status, see .planning/ROADMAP.md*
